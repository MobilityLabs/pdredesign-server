<div class="categories">
  <div class="row sort-by" ng-if="vm.isAssessment">
    <div>
      <sort-by categories="vm.categories" data="vm.data"></sort-by>
    </div>
    <div>
      <ng-include src="client/views/directives/consensus/filter_by_role.html"></ng-include>
    </div>
  </div>
  <div class="category" ng-repeat="category in vm.categories" ng-if="vm.displayMode === 'category'">
    <div class="row">
      <p class="category-label" ng-click="vm.toggleCategoryAnswers(category)" ng-if="vm.isAssessment">
        <i class="fa fa-chevron-right" ng-class="{'fa-chevron-down' : category.toggled === true}"></i>
        {{category.name}}
      </p>
      <div
          class="question-container question-{{question.id}}"
          ng-class="{'analysis-consensus-question': vm.isAnalysis}"
          ng-repeat="question in category.questions">
        <div class="question-row" ng-click="vm.toggleAnswers(question, $event)">
          <div class="question">
            <p class="question-id scored-{{question.score.value}}" ng-show="question.loading">
              <i class="fa fa-spinner fa-spin"></i>
            </p>
            <p id="question-{{question.number}}" class="question-id {{vm.questionColor(question, isConsensus)}}"
               ng-hide="question.loading">
              <a ng-href="#question-{{question.id}}"></a>
              {{question.number}}
            </p>
          </div>
          <div class="question-content" ng-class="{expanded: question.answersVisible}">
            <div class="question-header">
              <p class="question-headline">{{question.headline}}</p>
              <p class="content">{{question.content}}</p>
            </div>
            <response-answer-group question="question" is-consensus="true" ng-if="vm.isAssessment" scores="vm.scores"
                                   show-skip=false></response-answer-group>
            <analysis-consensus-answer question="question" ng-if="vm.isAnalysis" product-entries="vm.productEntries"
                                       inventory-data-entries="vm.dataEntries"></analysis-consensus-answer>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="category" ng-if="vm.displayMode === 'variance'">
    <div
        class="question-container question-{{question.id}}"
        ng-repeat="question in vm.varianceOrderedQuestions">
      <div class="question-row" ng-click="vm.toggleAnswers(question, $event)">
        <div class="question">
          <p class="question-id scored-{{question.score.value}}" ng-show="question.loading">
            <i class="fa fa-spinner fa-spin"></i>
          </p>
          <p id="question-{{question.number}}" class="question-id {{vm.questionColor(question, isConsensus)}}"
             ng-hide="question.loading">
            <a ng-href="#question-{{question.id}}"></a>
            {{question.number}}
          </p>
        </div>
        <div class="question-content" ng-class="{expanded: question.answersVisible}">
          <div class="question-header">
            <p class="question-headline">{{question.headline}}</p>
            <p class="content">{{question.content}}</p>
          </div>
          <response-answer-group question="question" is-consensus="true" scores="vm.scores"
                                 show-skip=false></response-answer-group>
        </div>
      </div>
    </div>
  </div>
</div>
